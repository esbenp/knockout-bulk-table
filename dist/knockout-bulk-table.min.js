!function(e,t){"function"==typeof define&&define.amd?define(["knockout","jquery","bootstrap"],t):"object"==typeof exports?module.exports=t(require("knockout"),require("jquery"),require("bootstrap")):e.Bulktable=t(e.ko,e.jQuery,e.jQuery)}(this,function(e,t,n){var s=function(t,n,s){this.collection=t,this.actions=n,this.settings=this.generateSettings(s),this.checked=e.observableArray(),this.checkedCollection=this.createCheckedCollectionObservable(),this.checkedCount=this.createCheckedCountObservable(),this.masterIsChecked=this.createMasterCheckboxObservable(),this.showActions=this.createShowActionsObservable(),this.showActionsMenu=e.observable(!1)};return s.DEFAULTS={actionsTemplate:"<div style='position:relative;'><input type='checkbox' data-bind='checked: masterIsChecked' style='position:absolute;z-index:1;top:1px;'><div class='dropdown' data-bind=\"css: {'open': showActionsMenu() === true}, style: {display: showActions() === true ? 'block' : 'none'}\" style='position:absolute;left:-8px;top:-4px;z-index:0;'><button class='btn btn-default btn-sm' style='padding-left:25px' data-bind='click: toggleActionsMenu'><span class='bulk-actions-label'></span></button><ul class='dropdown-menu' data-bind='foreach: actions'><li><a href='javascript:;' data-bind='click: $parent.click.bind(this, click), html: label'></a></li></ul></div></div>",checkProperty:"id",label:"item(s) selected <span class='caret'></span>",showCheckedCountInLabel:!0},s.prototype.createCheckedCollectionObservable=function(){var t=this;return e.computed(function(){var n=t.collection(),s=t.checked();return e.utils.arrayFilter(n,function(n){return-1!==e.utils.arrayIndexOf(s,e.unwrap(n[t.settings.checkProperty]))})},this)},s.prototype.createCheckedCountObservable=function(){return e.computed(function(){return this.checked().length},this)},s.prototype.createMasterCheckboxObservable=function(){return e.computed({read:function(){return this.checked().length===this.collection().length},write:function(t){if(this.checked([]),t===!0){var n=this;e.utils.arrayForEach(this.collection(),function(t){n.checked.push(e.unwrap(t[n.settings.checkProperty]))})}},owner:this})},s.prototype.createShowActionsObservable=function(){return e.computed(function(){return this.checked().length>0},this)},s.prototype.generateSettings=function(e){return t.extend({},s.DEFAULTS,e)},e.bindingHandlers.bulkActions={init:function(n,s,c){var o=t(n),i=s(),r=t(i.settings.actionsTemplate),a=r.find(".bulk-actions-label"),l="";i.settings.showCheckedCountInLabel===!0&&(l+="<span data-bind='text: checkedCount'></span> "),l+=i.settings.label,a.html(l),o.css("vertical-align","top"),r.appendTo(o);var h=function(){return i.showActionsMenu(!i.showActionsMenu()),!0};return e.applyBindings({actions:i.actions,click:function(e){var t=function(){h(),i.masterIsChecked(!1)};e.call(this,i.checkedCollection,t)},checkedCount:i.checkedCount,showActions:i.showActions,showActionsMenu:i.showActionsMenu,masterIsChecked:i.masterIsChecked,toggleActionsMenu:h},r[0]),{controlsDescendantBindings:!0}}},s});